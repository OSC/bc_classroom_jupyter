<%-
  groups = OodSupport::User.new.groups.sort_by(&:id).tap do |groups|
    groups.unshift(groups.delete(OodSupport::Process.group))
  end.map(&:name).grep(/^P./)

  classrooms = OodAppkit.clusters.each_with_object({}) do |cluster, hash|
    if cluster.kubernetes?
      hash.merge!(cluster.custom_config[:classrooms].to_h)
    end
  end.select do |k,v|
    k.start_with?('jupyter') && groups.include?(v)
  end.map do |k,v|
    [ k.gsub('jupyter/', ''), v ]
  end
-%>
---
cluster:
  - "kubernetes"
  - "kubernetes-test"
  - "kubernetes-dev"
form:
  - classroom
  - account
  - jupyterlab_switch
  - size
  - time
attributes:
  account:
    widget: "hidden_field"
  jupyterlab_switch:
    widget: "check_box"
    label: "Use JupyterLab instead of Jupyter Notebook?"
    help: |
      JupyterLab is the next generation of Jupyter, and is completely compatible with existing Jupyter Notebooks.
  time:
    widget: "select"
    options:
      - [ "1.5 hours", "1.5"]
      - [ "3 hours", "3"]
      - [ "6 hours", "6"]
    required: true
  size:
    widget: "select"
    options:
      - "small"
      - "medium"
      - "large"
      - "exra-large"
    help: |
      * **small** - less than 1 core & 2 GB of memory.
      * **medium** - 2 cores & 8 GB of memory.
      * **large** - 4 cores & 16 GB of memory.
      * **extra-large** - 8 cores & 32 GB of memory.
  classroom:
  <%- if classrooms.size >= 1 -%>
    widget: select
    options:
      <%- classrooms.each do |key, value| %>
      - [
        "<%= key.gsub('_', ' ') %>", "<%= key %>",
        data-set-account: "<%= value %>"
        ]
      <%- end %>
  <%- else -%>
    widget: hidden_field
    value: 'no_classroom'
  <%- end -%>
